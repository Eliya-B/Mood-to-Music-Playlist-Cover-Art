<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mood To Music Playlist</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .content-wrapper {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 20px;
            margin-top: 20px;
        }
        .input-section {
            text-align: center;
        }
        .section {
            min-height: 400px;
            display: flex;
            flex-direction: column;
        }
        input {
            padding: 10px;
            margin: 10px 0;
            width: 80%;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 16px;
        }
        button {
            background-color: #4a90e2;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            transition: background-color 0.3s;
        }
        button:hover {
            background-color: #357abd;
        }
        .status-message {
            margin-top: 20px;
            color: #4a90e2;
            font-style: italic;
            display: none;
        }
        .current-moods,
        .previous-moods {
            padding: 15px;
            background-color: #f9f9f9;
            border-radius: 8px;
            height: 100%;
            max-height: 400px;
            overflow-y: auto;
        }
        .current-moods {
            border: 2px solid #4a90e2;
        }
        .mood-entry {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            margin: 5px 0;
            background-color: white;
            border-radius: 4px;
            border-left: 4px solid #4a90e2;
        }
        #currentMoodList, #moodList {
            max-height: calc(100% - 40px);
            overflow-y: auto;
        }
        .mood-content {
            flex-grow: 1;
        }
        .timestamp {
            color: #666;
            font-size: 0.8em;
            margin-top: 4px;
        }
        h1, h2, h3 {
            color: #333;
        }
        .centered {
            text-align: center;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1 class="centered">Mood To Music Playlist</h1>
        
        <div class="content-wrapper">
            <div class="input-section section">
                <h3>Enter Mood Here</h3>
                <input type="text" id="moodInput" placeholder="How are you feeling?">
                <button id="generateButton">Generate Playlist</button>
                <div id="statusMessage" class="status-message"></div>
            </div>

            <div class="current-moods section">
                <h2>Current Moods</h2>
                <div id="currentMoodList"></div>
            </div>

            <div class="previous-moods section">
                <h2>Previous Moods</h2>
                <div id="moodList"></div>
            </div>
        </div>
    </div>

    <script>
        // Initialize mood history from localStorage or empty array
        let moodHistory = JSON.parse(localStorage.getItem('moodHistory')) || [];
        // Initialize current session moods
        let currentSessionMoods = [];

        // Function to save moods to localStorage
        function saveMoods() {
            localStorage.setItem('moodHistory', JSON.stringify(moodHistory));
        }

        // Function to create a mood entry element
        function createMoodEntry(entry, index, includeDelete = true) {
            const moodEntry = document.createElement('div');
            moodEntry.className = 'mood-entry';
            
            const date = new Date(entry.timestamp);
            const formattedDate = date.toLocaleString();

            let deleteButton = '';
            if (includeDelete) {
                deleteButton = `<button onclick="deleteMood(${index})" style="background-color: #ff4444;">âœ–</button>`;
            }

            moodEntry.innerHTML = `
                <div class="mood-content">
                    <div>${entry.mood}</div>
                    <div class="timestamp">${formattedDate}</div>
                </div>
                ${deleteButton}
            `;
            return moodEntry;
        }

        // Function to display current session moods
        function displayCurrentMoods() {
            const currentMoodList = document.getElementById('currentMoodList');
            currentMoodList.innerHTML = ''; // Clear current display

            currentSessionMoods.forEach((entry, index) => {
                const moodEntry = createMoodEntry(entry, index, false);
                currentMoodList.appendChild(moodEntry);
            });
        }

        // Function to display persistent moods
        function displayMoods() {
            const moodList = document.getElementById('moodList');
            moodList.innerHTML = ''; // Clear current display

            moodHistory.forEach((entry, index) => {
                const moodEntry = createMoodEntry(entry, index, true);
                moodList.appendChild(moodEntry);
            });
        }

        // Function to delete a mood
        function deleteMood(index) {
            moodHistory.splice(index, 1);
            saveMoods();
            displayMoods();
        }

        // Display existing moods on page load
        displayMoods();

        document.getElementById('generateButton').addEventListener('click', function() {
            const moodInput = document.getElementById('moodInput');
            const statusMessage = document.getElementById('statusMessage');
            const mood = moodInput.value.trim();

            if (mood) {
                // Store the mood with timestamp
                const moodEntry = {
                    mood: mood,
                    timestamp: new Date().toISOString()
                };
                
                // Add to both current session and persistent storage
                currentSessionMoods.unshift(moodEntry);
                moodHistory.unshift(moodEntry);
                
                // Update displays and save to localStorage
                saveMoods();
                displayCurrentMoods();
                displayMoods();

                // Show brief confirmation
                statusMessage.style.display = 'block';
                statusMessage.textContent = 'Mood recorded! Generating playlist...';
                
                // Clear the input
                moodInput.value = '';

                // Hide the message after 2 seconds
                setTimeout(() => {
                    statusMessage.style.display = 'none';
                }, 2000);
            }
        });
    </script>
</body>
</html>